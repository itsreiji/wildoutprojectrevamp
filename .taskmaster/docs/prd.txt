# Product Requirements Document (PRD) - WildOut!

## Overview
WildOut! is a media digital nightlife and event platform connecting artists, events, and experiences. Scalable for 500+ events, 50K+ members, 100+ partners. Focus on admin dashboard for CRUD, public landing page, Supabase backend with RBAC (admin/editor/member).

## Core Features
### 1. Authentication (RBAC)
- Supabase Auth with roles: admin (full CRUD), editor (own records), member (read-only).
- Custom claims: app_metadata.role synced to profiles.role table.
- RLS policies: e.g., events SELECT/INSERT/UPDATE/DELETE based on (auth.jwt() ->> 'role') = 'admin' OR (id = profile.id for editor).
- React hooks: useSession, useUser, protected routes.

### 2. Event Management CRUD
- Tables: events (id, title, status, start_date, end_date, partner_id), event_artists, gallery_items (event_id).
- Admin dashboard: list/table (TanStack Table shadcn), create/edit forms (React Hook Form, Zod), delete, optimistic updates.
- Infinite scroll/query for large lists.

### 3. Partner Management CRUD
- Table: partners (id, name, status, sponsorship_level).
- Tiered visibility, sponsor events.

### 4. Team Management CRUD
- Table: team_members (id, name, role, status).
- Public display section.

### 5. Content Management CRUD
- Hero content, about, site settings (jsonb).
- StaticContentContext -> TanStack Query migration.

## Technical Architecture
- **Frontend**: Vite React TS Tailwind Shadcn UI TanStack Query (migrate contexts) TanStack Router (replace custom router, file-based).
- **Backend**: Supabase Postgres Auth Storage Edge Functions.
- **State**: TanStack Query v5 + @supabase-cache-helpers/postgrest-react-query for caching/optimistic.
- **UI**: Shadcn dashboard layout (sidebar, tables, forms).
- **Auth Guard**: Router beforeLoad check session.role.

## Development Roadmap
### MVP Phase 1: Foundation
1. Migrate routing to TanStack Router (file-based /dashboard/events etc).
2. Setup QueryClientProvider, migrate AuthContext/EventsContext to queries.
3. RBAC: profiles table, Edge Function post-signup set role, RLS policies.

### Phase 2: Dashboard CRUD
4. Dashboard layout (shadcn sidebar nav).
5. Events CRUD table/form (TanStack Query mutations optimistic).
6. Partners CRUD.
7. Team CRUD.

### Phase 3: Content/Public
8. Content CRUD (hero/about).
9. Public landing polish.
10. Gallery upload (Supabase Storage, RLS).

## Logical Dependency Chain
1. Supabase schema/types gen (types.ts).
2. Auth/RBAC foundation.
3. Query migration.
4. Router migration.
5. Dashboard layout.
6. Events CRUD (test RBAC).
7. Others parallel after layout.

## Risks/Mitigations
- RLS bugs: Test policies in Supabase dashboard.
- Query migration: Incremental, keep contexts as fallback.
- Router: Virtual routes for dashboard.

## Appendix
- ERD from AGENTS.md.
- Mockup ref: Git commit b62b3e27dca9ccd6dd8fd58bdd6745b618e9d3f9.
- MCP Supabase server for all DB ops.
